<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=US-ASCII" http-equiv="Content-Type">

<title>module Eve::Trust - eve 2.0.1</title>

<link type="text/css" media="screen" href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/darkfish.js"></script>


<body id="top" class="module">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../index.html">Home</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/eve/trust.rb
    <li>lib/eve/trust/controller_helpers.rb
    <li>lib/eve/trust/igb_interface.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    
    
    
  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../README_rdoc.html">README</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../Eve.html">Eve</a>
  
    <li><a href="../Eve/API.html">Eve::API</a>
  
    <li><a href="../Eve/API/Connectivity.html">Eve::API::Connectivity</a>
  
    <li><a href="../Eve/API/Request.html">Eve::API::Request</a>
  
    <li><a href="../Eve/API/Response.html">Eve::API::Response</a>
  
    <li><a href="../Eve/API/Response/Result.html">Eve::API::Response::Result</a>
  
    <li><a href="../Eve/API/Response/Row.html">Eve::API::Response::Row</a>
  
    <li><a href="../Eve/API/Response/Rowset.html">Eve::API::Response::Rowset</a>
  
    <li><a href="../Eve/API/Services.html">Eve::API::Services</a>
  
    <li><a href="../Eve/API/Services/Account.html">Eve::API::Services::Account</a>
  
    <li><a href="../Eve/API/Services/Character.html">Eve::API::Services::Character</a>
  
    <li><a href="../Eve/API/Services/Corporation.html">Eve::API::Services::Corporation</a>
  
    <li><a href="../Eve/API/Services/Eve.html">Eve::API::Services::Eve</a>
  
    <li><a href="../Eve/API/Services/Map.html">Eve::API::Services::Map</a>
  
    <li><a href="../Eve/API/Services/Misc.html">Eve::API::Services::Misc</a>
  
    <li><a href="../Eve/API/Services/Server.html">Eve::API::Services::Server</a>
  
    <li><a href="../Eve/Errors.html">Eve::Errors</a>
  
    <li><a href="../Eve/Errors/AuthenticationError.html">Eve::Errors::AuthenticationError</a>
  
    <li><a href="../Eve/Errors/AuthenticationErrors.html">Eve::Errors::AuthenticationErrors</a>
  
    <li><a href="../Eve/Errors/AuthenticationErrors/AuthenticationFailure.html">Eve::Errors::AuthenticationErrors::AuthenticationFailure</a>
  
    <li><a href="../Eve/Errors/AuthenticationErrors/CachedKeyAuthFailure.html">Eve::Errors::AuthenticationErrors::CachedKeyAuthFailure</a>
  
    <li><a href="../Eve/Errors/AuthenticationErrors/InadequateSecurityLevel.html">Eve::Errors::AuthenticationErrors::InadequateSecurityLevel</a>
  
    <li><a href="../Eve/Errors/AuthenticationErrors/LastAuthenticationFailure.html">Eve::Errors::AuthenticationErrors::LastAuthenticationFailure</a>
  
    <li><a href="../Eve/Errors/AuthenticationErrors/LoginDenied.html">Eve::Errors::AuthenticationErrors::LoginDenied</a>
  
    <li><a href="../Eve/Errors/AuthenticationErrors/MissingRoles.html">Eve::Errors::AuthenticationErrors::MissingRoles</a>
  
    <li><a href="../Eve/Errors/AuthenticationErrors/NotAvailable.html">Eve::Errors::AuthenticationErrors::NotAvailable</a>
  
    <li><a href="../Eve/Errors/AuthenticationErrors/NotInAlliance.html">Eve::Errors::AuthenticationErrors::NotInAlliance</a>
  
    <li><a href="../Eve/Errors/AuthenticationErrors/WrongAccount.html">Eve::Errors::AuthenticationErrors::WrongAccount</a>
  
    <li><a href="../Eve/Errors/InternalError.html">Eve::Errors::InternalError</a>
  
    <li><a href="../Eve/Errors/InternalErrors.html">Eve::Errors::InternalErrors</a>
  
    <li><a href="../Eve/Errors/InternalErrors/CSVMismatch.html">Eve::Errors::InternalErrors::CSVMismatch</a>
  
    <li><a href="../Eve/Errors/InternalErrors/CacheUtilMissing.html">Eve::Errors::InternalErrors::CacheUtilMissing</a>
  
    <li><a href="../Eve/Errors/InternalErrors/CharacterInformationFailure.html">Eve::Errors::InternalErrors::CharacterInformationFailure</a>
  
    <li><a href="../Eve/Errors/InternalErrors/CorporationInformationFailure.html">Eve::Errors::InternalErrors::CorporationInformationFailure</a>
  
    <li><a href="../Eve/Errors/InternalErrors/FactionMemberInformationFailure.html">Eve::Errors::InternalErrors::FactionMemberInformationFailure</a>
  
    <li><a href="../Eve/Errors/InternalErrors/InvalidAccountKey.html">Eve::Errors::InternalErrors::InvalidAccountKey</a>
  
    <li><a href="../Eve/Errors/InternalErrors/InvalidAttribute.html">Eve::Errors::InternalErrors::InvalidAttribute</a>
  
    <li><a href="../Eve/Errors/InternalErrors/InvalidBloodline.html">Eve::Errors::InternalErrors::InvalidBloodline</a>
  
    <li><a href="../Eve/Errors/InternalErrors/InvalidCharID.html">Eve::Errors::InternalErrors::InvalidCharID</a>
  
    <li><a href="../Eve/Errors/InternalErrors/InvalidCorpID.html">Eve::Errors::InternalErrors::InvalidCorpID</a>
  
    <li><a href="../Eve/Errors/InternalErrors/InvalidCredentials.html">Eve::Errors::InternalErrors::InvalidCredentials</a>
  
    <li><a href="../Eve/Errors/InternalErrors/InvalidGender.html">Eve::Errors::InternalErrors::InvalidGender</a>
  
    <li><a href="../Eve/Errors/InternalErrors/InvalidInput.html">Eve::Errors::InternalErrors::InvalidInput</a>
  
    <li><a href="../Eve/Errors/InternalErrors/InvalidOrNotLoaded.html">Eve::Errors::InternalErrors::InvalidOrNotLoaded</a>
  
    <li><a href="../Eve/Errors/InternalErrors/InvalidRace.html">Eve::Errors::InternalErrors::InvalidRace</a>
  
    <li><a href="../Eve/Errors/InternalErrors/InvalidRefType.html">Eve::Errors::InternalErrors::InvalidRefType</a>
  
    <li><a href="../Eve/Errors/InternalErrors/InvalidUserID.html">Eve::Errors::InternalErrors::InvalidUserID</a>
  
    <li><a href="../Eve/Errors/InternalErrors/MailNotAvailable.html">Eve::Errors::InternalErrors::MailNotAvailable</a>
  
    <li><a href="../Eve/Errors/InternalErrors/MedalInformationFailure.html">Eve::Errors::InternalErrors::MedalInformationFailure</a>
  
    <li><a href="../Eve/Errors/InternalErrors/MissingCorporation.html">Eve::Errors::InternalErrors::MissingCorporation</a>
  
    <li><a href="../Eve/Errors/InternalErrors/NotificationsNotAvailable.html">Eve::Errors::InternalErrors::NotificationsNotAvailable</a>
  
    <li><a href="../Eve/Errors/InternalErrors/NullAttributeID.html">Eve::Errors::InternalErrors::NullAttributeID</a>
  
    <li><a href="../Eve/Errors/InternalErrors/RolesQueryFailure.html">Eve::Errors::InternalErrors::RolesQueryFailure</a>
  
    <li><a href="../Eve/Errors/InternalErrors/StarbaseDetailFailure.html">Eve::Errors::InternalErrors::StarbaseDetailFailure</a>
  
    <li><a href="../Eve/Errors/InternalErrors/TQTimeFailure.html">Eve::Errors::InternalErrors::TQTimeFailure</a>
  
    <li><a href="../Eve/Errors/InternalErrors/UnexpectedDatabaseFailure.html">Eve::Errors::InternalErrors::UnexpectedDatabaseFailure</a>
  
    <li><a href="../Eve/Errors/InternalErrors/UserInformationFailure.html">Eve::Errors::InternalErrors::UserInformationFailure</a>
  
    <li><a href="../Eve/Errors/InvalidRowset.html">Eve::Errors::InvalidRowset</a>
  
    <li><a href="../Eve/Errors/MiscellaneousError.html">Eve::Errors::MiscellaneousError</a>
  
    <li><a href="../Eve/Errors/MiscellaneousErrors.html">Eve::Errors::MiscellaneousErrors</a>
  
    <li><a href="../Eve/Errors/MiscellaneousErrors/BackendDatabaseDisabled.html">Eve::Errors::MiscellaneousErrors::BackendDatabaseDisabled</a>
  
    <li><a href="../Eve/Errors/MiscellaneousErrors/BetaInProgress.html">Eve::Errors::MiscellaneousErrors::BetaInProgress</a>
  
    <li><a href="../Eve/Errors/MiscellaneousErrors/RateLimited.html">Eve::Errors::MiscellaneousErrors::RateLimited</a>
  
    <li><a href="../Eve/Errors/MiscellaneousErrors/SiteDatabaseDisabled.html">Eve::Errors::MiscellaneousErrors::SiteDatabaseDisabled</a>
  
    <li><a href="../Eve/Errors/MiscellaneousErrors/TestErrorForced.html">Eve::Errors::MiscellaneousErrors::TestErrorForced</a>
  
    <li><a href="../Eve/Errors/UnknownError.html">Eve::Errors::UnknownError</a>
  
    <li><a href="../Eve/Errors/UserInputError.html">Eve::Errors::UserInputError</a>
  
    <li><a href="../Eve/Errors/UserInputErrors.html">Eve::Errors::UserInputErrors</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/AccountKeyOutOfBounds.html">Eve::Errors::UserInputErrors::AccountKeyOutOfBounds</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/AssetsAlreadyDownloaded.html">Eve::Errors::UserInputErrors::AssetsAlreadyDownloaded</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/CharacterNotEnlisted.html">Eve::Errors::UserInputErrors::CharacterNotEnlisted</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/CorporationNotEnlisted.html">Eve::Errors::UserInputErrors::CorporationNotEnlisted</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/IndustryJobsAlreadyDownloaded.html">Eve::Errors::UserInputErrors::IndustryJobsAlreadyDownloaded</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/InvalidAccountKey.html">Eve::Errors::UserInputErrors::InvalidAccountKey</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/InvalidBeforeKillID.html">Eve::Errors::UserInputErrors::InvalidBeforeKillID</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/InvalidBeforeRefID.html">Eve::Errors::UserInputErrors::InvalidBeforeRefID</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/InvalidBeforeTransID.html">Eve::Errors::UserInputErrors::InvalidBeforeTransID</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/InvalidCharacterID.html">Eve::Errors::UserInputErrors::InvalidCharacterID</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/InvalidIDList.html">Eve::Errors::UserInputErrors::InvalidIDList</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/InvalidInteger.html">Eve::Errors::UserInputErrors::InvalidInteger</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/InvalidItemID.html">Eve::Errors::UserInputErrors::InvalidItemID</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/InvalidNameList.html">Eve::Errors::UserInputErrors::InvalidNameList</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/KeyNotFound.html">Eve::Errors::UserInputErrors::KeyNotFound</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/KillsExhausted.html">Eve::Errors::UserInputErrors::KillsExhausted</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/KillsNotLoaded.html">Eve::Errors::UserInputErrors::KillsNotLoaded</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/KillsPreviouslyLoaded.html">Eve::Errors::UserInputErrors::KillsPreviouslyLoaded</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/MarketOrdersAlreadyDownloaded.html">Eve::Errors::UserInputErrors::MarketOrdersAlreadyDownloaded</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/MissingUserID.html">Eve::Errors::UserInputErrors::MissingUserID</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/RetryLater.html">Eve::Errors::UserInputErrors::RetryLater</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/VersionEscalationNotAllowed.html">Eve::Errors::UserInputErrors::VersionEscalationNotAllowed</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/VersionMismatch.html">Eve::Errors::UserInputErrors::VersionMismatch</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/WalletExhausted.html">Eve::Errors::UserInputErrors::WalletExhausted</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/WalletNotLoaded.html">Eve::Errors::UserInputErrors::WalletNotLoaded</a>
  
    <li><a href="../Eve/Errors/UserInputErrors/WalletPreviouslyLoaded.html">Eve::Errors::UserInputErrors::WalletPreviouslyLoaded</a>
  
    <li><a href="../Eve/JavascriptHelper.html">Eve::JavascriptHelper</a>
  
    <li><a href="../Eve/Railtie.html">Eve::Railtie</a>
  
    <li><a href="../Eve/Trust.html">Eve::Trust</a>
  
    <li><a href="../Eve/Trust/ControllerHelpers.html">Eve::Trust::ControllerHelpers</a>
  
    <li><a href="../Eve/Trust/IgbInterface.html">Eve::Trust::IgbInterface</a>
  
    <li><a href="../Eve/Version.html">Eve::Version</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="module">module Eve::Trust</h1>

  <div id="description" class="description">
    
<h2 id="label-Trust"><a href="Trust.html">Trust</a></h2>

<p>The primary purpose for the ActionController is to figure out which View
should be rendered, and what data to send to that View. In keeping with
this paradigm, a few helper methods have been added that allow you to
establish trust with the In-Game Browser (IGB), which in turn provides
access to more useful information such as the player's current location. To
establish trust with a compatible browser, simply add one line to your
controller:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">AnyController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ApplicationController</span>
  <span class="ruby-identifier">requires_trust</span>
<span class="ruby-keyword">end</span>
</pre>

<p>This will cause the in-game browser to prompt the user, asking him/her to
complete the handshake. If they refuse, the page will not load. To
establish <em>optional</em> trust -- that is, to allow the page to load
even if the user hasn't granted the trust request -- you can use
<code>prefers_trust</code> instead:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">AnyController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ApplicationController</span>
  <span class="ruby-identifier">prefers_trust</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Both methods also accept a custom trust request message that will be shown
to the user when they are prompted:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">AnyController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ApplicationController</span>
  <span class="ruby-identifier">prefers_trust</span> <span class="ruby-string">&quot;To take full advantage of the features on this site, please grant this trust request.&quot;</span>
<span class="ruby-keyword">end</span>
</pre>

<h2 id="label-IGB+Headers">IGB Headers</h2>

<p>After trust has been established, the IGB sends additional content headers
to the server with every request. These headers contain the most up-to-date
information regarding the current user, his/her location, his/her character
ID, and so on. The character ID could, for example, be used in conjunction
with <a href="API.html">Eve::API</a> to show the character's portrait in a
forum.</p>

<p>To gain access to this extra information, use the <code>igb</code> method:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">AnyController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ApplicationController</span>
  . . .
  <span class="ruby-identifier">def</span> <span class="ruby-identifier">index</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">igb?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">igb</span>.<span class="ruby-identifier">trusted?</span>                  <span class="ruby-comment"># if the client is using the IGB and trust has been established</span>
      <span class="ruby-ivar">@solar_system</span> = <span class="ruby-identifier">igb</span>.<span class="ruby-identifier">solar_system_name</span>  <span class="ruby-comment"># then make a note of the current solar system</span>
      <span class="ruby-ivar">@character_id</span> = <span class="ruby-identifier">igb</span>.<span class="ruby-identifier">character_id</span>       <span class="ruby-comment"># and the character ID</span>
    <span class="ruby-keyword">else</span>
      . . .                                  <span class="ruby-comment"># handle a non-IGB browser such as Internet Explorer or Firefox.</span>
    <span class="ruby-identifier">end</span>
  <span class="ruby-keyword">end</span>
</pre>

<p>To find out which methods are exposed by the <code>igb</code> method, take
a look at <a href="Trust/IgbInterface.html">Eve::Trust::IgbInterface</a>.</p>

<h2 id="label-View+Format">View Format</h2>

<p>In Rails, the View is usually rendered in HTML format. That means the view
template is usually called <code>some_action_name.html.erb</code> , where
"some_action_name" is the name of the current action and "html" is the file
format. This library exposes a new format, "igb", which allows you to
render an IGB-specific response. This response is expected to be in
IGB-compatible HTML format. Here's an example of what an IGB file might
look like:</p>

<pre>&lt;%=link_to_evemail &quot;Check Your Mail!&quot;%&gt;
&lt;%if igb.trusted?%&gt;
  &lt;p&gt;Thanks for your trust! I see you're currently in &lt;%=igb.solar_system_name%&gt;.&lt;/p&gt;
  &lt;p&gt;Here's some information about our secret headquarters:&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;%=link_to_route &quot;Click For Directions&quot;, &quot;Jita&quot;%&gt;&lt;/li&gt;
    &lt;li&gt;&lt;%=link_to_map &quot;Show On Map&quot;, &quot;Jita&quot;%&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;%end%&gt;</pre>

<p>For more information about the various helpers available to your
IGB-specific views, take a look at Eve::Helpers::JavascriptHelper.</p>

<p>If the client is using the EVE In-Game Browser, then the
"action_name.igb.erb" file will be automatically used, provided it exists.
If the matching file is not found, then "action_name.html.erb" will be used
in its place, just as if the client were using any other browser such as
Internet Explorer or Firefox. You can also explicitly require that the .igb
file be rendered using the <code>set_igb</code> method:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">AnyController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ApplicationController</span>
  <span class="ruby-identifier">before_filter</span> :<span class="ruby-identifier">check_for_igb_requirement</span>
  <span class="ruby-identifier">private</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">check_for_igb_requirement</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">some_condition</span>)
      <span class="ruby-identifier">set_igb</span> <span class="ruby-comment"># force the IGB template for this action to be rendered</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    <!-- Methods -->
    
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

